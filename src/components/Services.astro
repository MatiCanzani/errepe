---
import { Image } from "astro:assets";
import Logo from "../images/logo-black.svg";
import servicesData from "../data/Services";
import Card from "./Card.astro";
---

<div
  class="container w-11/12 md:w-full flex mx-auto justify-center items-end flex-col h-full py-20 relative"
  id="textSection"
>
  <div class="w-full flex justify-end my-4 xl:my-20">
    <p
      class="uppercase text-black text-8xl md:text-[27rem] opacity-10 font-compactaBT leading-none mr-60"
    >
      errepé
    </p>
    <Image src={Logo} alt="ERP" />
  </div>
  <div class="flex text-right xl:mr-12 xl:absolute xl:top-[49rem] xl:right-[30rem]">
    <h2
      class="flex-grow text-deep-blue text-2xl md:text-4xl font-FormaDJRMicro font-extrabold py-4 mb-10 xl:mb-0"
    >
      A lo que nos dedicamos:
    </h2>
  </div>

  
  <div class="text-right h-full w-full ">
    <div id="services" class="flex flex-col text-end items-end grow">
      {
        servicesData &&
          servicesData.map((service) => (
            <>
              <button
                class="uppercase text-deep-blue text-[5rem] md:text-[8rem] xl:text-[12rem] font-compactaBT leading-[100%] service-word touch-auto after:bg-deep-blue after:absolute after:h-1 after:w-0 after:bottom-0 after:left-0 xl:hover:after:w-full after:transition-all after:duration-300"
                id={service.title}
              >
                <span class="link-underline link-underline-black">
                  {service.title}
                </span>
              </button>
              <Card description={service.description} id={service.id} />
            </>
          ))
      }
    </div>
  </div>

  <div class="w-full flex flex-end text-right">
    <p
      class="text-deep-blue text-xl xl:text-4xl font-extrabold font-FormaDJRMicro mt-10 pl-[30%]"
    >
      Poseemos nuestra propia infraestrucutura, contando con un centro de
      producción gastronómico propio, que brinda serivicio tanto para eventos
      como para comercios.
    </p>
  </div>
  <div
    class="text-right gap-4 flex justify-center flex-col text-deep-blue text-xl xl:text-3xl font-extrabold font-FormaDJRMicro mt-10"
  >
    <p>Descarga Nuestro Catálogos</p>

    <div class="flex justify-space gap-4 font-extrabold">
      <a
        href="/catalogos/Mobiliario Chill out - Coctail - complementos deco_compressed.pdf"
        download
        class="group transition duration-300"
        >Mobiliario Chill Out<span
          class="block max-w-0 group-hover:max-w-full transition-all duration-500 h-0.5 bg-black"
        ></span></a
      >
      -
      <a
        href="/catalogos/Catálogos Mesas de Banquete_compressed.pdf"
        download
        class="group transition duration-300"
        >Mesas de Banquete<span
          class="block max-w-0 group-hover:max-w-full transition-all duration-500 h-0.5 bg-black"
        ></span></a
      >
      -
      <a
        href="/catalogos/Dossier Pérgola Cubo_compressed.pdf"
        download
        class="group transition duration-300"
        >Pérgola Cubo<span
          class="block max-w-0 group-hover:max-w-full transition-all duration-500 h-0.5 bg-black"
        ></span></a
      >
    </div>
  </div>
</div>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  import SplitType from "split-type";
  import servicesData from "../data/Services";

  gsap.registerPlugin(ScrollTrigger);

  const split = new SplitType(".service-word");

  gsap.from(".char", {
    stagger: 0.5,
    delay: 0.2,
    opacity: 0.1,
    duration: 0.5,
    scrollTrigger: {
      trigger: "#textSection",
      once: true,
      scrub: 1,
      start: "top top",
      end: "bottom bottom",
    },
  });

  const funcToggle = (service: { id?: string }) => {
    console.log("service.id", service.id);
    const card = document.getElementById(`${service.id}`);
    card.classList.toggle("hidden");

    if (!card.classList.contains("hidden")) {
      gsap.from(card, {
        opacity: 0,
        y: -50,
      });
    }
  };

  const serviceTitles = document.querySelectorAll(".service-word");

  serviceTitles.forEach((serviceTitle) => {
    serviceTitle.addEventListener("click", () => {
      const clickedTitle = serviceTitle.textContent.trim();

      const service = servicesData.find((s) => s.title === clickedTitle);

      funcToggle(service);
    });
  });
</script>

<style>
  .link-underline {
    border-bottom-width: 0;
    background-image: linear-gradient(transparent, transparent),
      linear-gradient(#fff, #fff);
    background-size: 0 3px;
    background-position: 0 100%;
    background-repeat: no-repeat;
    transition: background-size 0.5s ease-in-out;
  }

  .link-underline-black {
    background-image: linear-gradient(transparent, transparent),
      linear-gradient(#121927, #121927);
  }

  .link-underline:hover {
    background-size: 100% 3px;
    background-position: 0 100%;
  }
</style>
